<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover"/>
<title>MultiCalc — Multi-Neon (Mobile, Full)</title>
<style>
:root{
  --bg:#05040a; --white:#eaf2ff; --muted:#9aa7c0;
  --neon1:#00f5a0; --neon2:#7c5cff; --neon3:#ff4da6; --neon4:#00d2ff;
}
*{box-sizing:border-box; -webkit-tap-highlight-color:transparent}
html,body{height:100%; margin:0; font-family:Inter,system-ui,Roboto,Arial; background:
  radial-gradient(800px 400px at 10% 10%, rgba(124,92,255,0.06), transparent 6%),
  radial-gradient(800px 400px at 90% 90%, rgba(0,213,255,0.03), transparent 6%),
  var(--bg); color:var(--white)}
.app{min-height:100vh; display:flex; align-items:flex-start; justify-content:center; padding:22px 16px 40px;}
.card{width:100%; max-width:520px; background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01)); border-radius:16px; padding:14px; border:1px solid rgba(255,255,255,0.03); box-shadow:0 10px 40px rgba(0,0,0,0.6)}
.hdr{display:flex; justify-content:space-between; align-items:center; gap:12px; margin-bottom:10px}
.brand{display:flex; gap:10px; align-items:center}
.logo{width:48px;height:48px;border-radius:10px;display:grid;place-items:center;font-weight:800;color:var(--bg);background:linear-gradient(135deg,var(--neon2),var(--neon3));box-shadow:0 6px 30px rgba(124,92,255,0.12)}
.title h1{margin:0;font-size:16px} .title p{margin:0;color:var(--muted);font-size:12px}
.hdr-actions{display:flex;gap:8px}
.miniBtn{padding:8px 10px;border-radius:10px;background:transparent;border:1px solid rgba(255,255,255,0.04);color:var(--muted);font-weight:700;font-size:13px}

/* Display */
.display{margin-top:6px;background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));border-radius:12px;padding:12px;border:1px solid rgba(255,255,255,0.03)}
.disp-top{display:flex;justify-content:space-between;color:var(--muted);font-size:12px}
.screen{font-size:30px;font-weight:800;text-align:right;margin-top:8px;word-break:break-all}

/* tabs */
.tabs{display:flex;gap:8px;margin-top:12px;overflow:auto;padding-bottom:4px}
.tab{flex:0 0 auto;padding:8px 12px;border-radius:10px;background:transparent;color:var(--muted);border:1px solid transparent;font-weight:700;cursor:pointer}
.tab.active{background:linear-gradient(90deg,var(--neon1),var(--neon2));color:#040414;box-shadow:0 8px 30px rgba(124,92,255,0.14)}

/* layout */
.content{display:grid;grid-template-columns:1fr;gap:12px;margin-top:10px}
@media(min-width:560px){ .content{grid-template-columns:1fr 380px} }

/* keypad */
.keypad{display:grid;grid-template-columns:repeat(4,1fr);gap:10px}
.key{padding:14px;border-radius:12px;text-align:center;font-weight:800;font-size:18px;background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));border:1px solid rgba(255,255,255,0.03);box-shadow:0 8px 24px rgba(0,0,0,0.6);color:var(--white);touch-action:manipulation;cursor:pointer}
.key:active{transform:translateY(2px)}
.key.op{background:linear-gradient(90deg,var(--neon3),var(--neon4));color:#05040a}
.key.func{background:linear-gradient(90deg,var(--neon1),var(--neon2));color:#05040a}
.key.zero{grid-column:span 2}
.key.eq{grid-column:span 1;background:linear-gradient(90deg,var(--neon4),var(--neon1));color:#05040a}

/* panel (right) */
.mode{background:transparent;padding:10px;border-radius:12px;border:1px solid rgba(255,255,255,0.02)}
.mode.hidden{display:none}
label{display:block;color:var(--muted);font-size:12px;margin-bottom:6px}
input[type=number],input[type=date],input[type=time],select{width:100%;padding:10px 12px;border-radius:10px;border:1px solid rgba(255,255,255,0.03);background:transparent;color:var(--white);font-weight:700}
.row{display:flex;gap:8px}
.col{flex:1}
.actions{display:flex;gap:8px;margin-top:10px}
.primary{flex:1;padding:12px;border-radius:10px;border:none;font-weight:800;background:linear-gradient(90deg,var(--neon2),var(--neon3));color:#040414}
.ghost{flex:1;padding:12px;border-radius:10px;background:transparent;border:1px solid rgba(255,255,255,0.03);color:var(--muted);font-weight:700}

/* history */
.history{margin-top:12px;max-height:220px;overflow:auto;padding-right:6px}
.hitem{padding:8px;border-radius:8px;margin-bottom:8px;background:linear-gradient(90deg, rgba(255,255,255,0.01), rgba(255,255,255,0.00));border:1px solid rgba(255,255,255,0.02);font-size:13px;color:var(--muted)}
small{color:var(--muted);}

/* small helpers */
.note{font-size:13px;color:var(--muted);margin-top:8px}
</style>
</head>
<body>
<div class="app">
  <div class="card" id="appCard">
    <div class="hdr">
      <div class="brand">
        <div class="logo">MC</div>
        <div class="title"><h1>MultiCalc</h1><p class="lead">Multi-Neon • Mobile</p></div>
      </div>
      <div class="hdr-actions">
        <button id="copyBtn" class="miniBtn">Copy</button>
        <button id="clearHistBtn" class="miniBtn">Clear</button>
      </div>
    </div>

    <div class="display" aria-live="polite">
      <div class="disp-top"><div id="modeName">Normal</div><div id="mem" style="color:var(--muted)"></div></div>
      <div id="screen" class="screen">0</div>
    </div>

    <div class="tabs" id="tabs">
      <div class="tab active" data-mode="normal">Normal</div>
      <div class="tab" data-mode="age">Age</div>
      <div class="tab" data-mode="interest">Interest</div>
      <div class="tab" data-mode="timediff">Time</div>
      <div class="tab" data-mode="hours">H+M</div>
    </div>

    <div class="content">
      <!-- left: keypad -->
      <div id="leftCol">
        <div id="keypadWrap">
          <div class="keypad" id="keypad">
            <div class="key func" data-key="C">C</div>
            <div class="key func" data-key="(">(</div>
            <div class="key func" data-key=")">)</div>
            <div class="key op" data-key="/">÷</div>

            <div class="key" data-key="7">7</div>
            <div class="key" data-key="8">8</div>
            <div class="key" data-key="9">9</div>
            <div class="key op" data-key="*">×</div>

            <div class="key" data-key="4">4</div>
            <div class="key" data-key="5">5</div>
            <div class="key" data-key="6">6</div>
            <div class="key op" data-key="-">−</div>

            <div class="key" data-key="1">1</div>
            <div class="key" data-key="2">2</div>
            <div class="key" data-key="3">3</div>
            <div class="key op" data-key="+">+</div>

            <div class="key zero" data-key="0">0</div>
            <div class="key" data-key=".">.</div>
            <div class="key op" data-key="%">%</div>

            <div class="key func" data-key="back">⌫</div>
            <div class="key func" data-key="ans">ANS</div>
            <div class="key eq" data-key="=">=</div>
          </div>
        </div>
        <div class="note">Tip: Keypad active in Normal mode. Switch tabs for other calculators.</div>
      </div>

      <!-- right: mode panels -->
      <div id="rightCol">
        <div id="mode-normal" class="mode">Normal mode uses keypad above. Enter expression, press =.</div>

        <div id="mode-age" class="mode hidden">
          <label for="dob">Birth date</label>
          <input id="dob" type="date" />
          <div class="actions"><button id="ageCalc" class="primary">Calculate</button><button id="ageClear" class="ghost">Clear</button></div>
          <div id="ageOut" style="margin-top:10px;font-weight:800"></div>
        </div>

        <div id="mode-interest" class="mode hidden">
          <label>Principal (₹)</label><input id="P" type="number" inputmode="numeric" />
          <div class="row" style="margin-top:8px">
            <div class="col"><label>Rate (%)</label><input id="R" type="number" step="any" inputmode="decimal" /></div>
            <div class="col"><label>Years</label><input id="T" type="number" inputmode="numeric" /></div>
          </div>
          <div style="display:flex;gap:8px;align-items:center;margin-top:8px">
            <input id="compound" type="checkbox" /><label style="margin:0;color:var(--muted)">Compound</label>
            <select id="nPer" style="margin-left:auto;display:none;width:120px">
              <option value="1">Annually</option><option value="2">Semi</option><option value="4">Quarterly</option><option value="12">Monthly</option>
            </select>
          </div>
          <div class="actions"><button id="intCalc" class="primary">Calculate</button><button id="intClear" class="ghost">Clear</button></div>
          <div id="intOut" style="margin-top:8px;font-weight:800"></div>
          <div id="intTable" style="margin-top:8px;color:var(--muted);font-size:13px"></div>
        </div>

        <div id="mode-timediff" class="mode hidden">
          <label>Start</label><input id="tStart" type="time" />
          <label style="margin-top:8px">End</label><input id="tEnd" type="time" />
          <div class="actions"><button id="timeCalc" class="primary">Get</button><button id="timeClear" class="ghost">Clear</button></div>
          <div id="timeOut" style="margin-top:8px;font-weight:800"></div>
        </div>

        <div id="mode-hours" class="mode hidden">
          <div class="row">
            <div class="col"><label>Hours 1</label><input id="h1" type="number" inputmode="numeric" /></div>
            <div class="col"><label>Min 1</label><input id="m1" type="number" inputmode="numeric" /></div>
          </div>
          <div class="row" style="margin-top:8px">
            <div class="col"><label>Hours 2</label><input id="h2" type="number" inputmode="numeric" /></div>
            <div class="col"><label>Min 2</label><input id="m2" type="number" inputmode="numeric" /></div>
          </div>
          <div class="actions"><button id="hmCalc" class="primary">Add</button><button id="hmClear" class="ghost">Clear</button></div>
          <div id="hmOut" style="margin-top:8px;font-weight:800"></div>
        </div>

        <div style="height:10px"></div>

        <div><strong style="font-size:14px">History</strong></div>
        <div class="history" id="history"></div>
      </div>
    </div>
  </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', ()=> {
  /* STATE */
  const screen = document.getElementById('screen');
  const tabs = document.querySelectorAll('.tab');
  const modes = ['normal','age','interest','timediff','hours'];
  let current = 'normal';
  let expr = '';
  let lastAns = null;
  let history = [];

  /* HISTORY HELPERS */
  function pushHist(text){
    history.unshift({t: new Date(), text});
    renderHist();
  }
  function renderHist(){
    const wrap = document.getElementById('history');
    if(history.length===0){ wrap.innerHTML = '<div class="hitem">No operations yet.</div>'; return; }
    wrap.innerHTML = history.map(h=>`<div class="hitem"><small>${h.t.toLocaleString()}</small><div style="margin-top:6px">${h.text}</div></div>`).join('');
  }
  document.getElementById('copyBtn').addEventListener('click', ()=>{
    if(history.length===0){ alert('History empty'); return; }
    navigator.clipboard?.writeText(history[0].text).then(()=> alert('Copied last'));
  });
  document.getElementById('clearHistBtn').addEventListener('click', ()=> { history=[]; renderHist(); });

  /* MODE SWITCH */
  tabs.forEach(t=> t.addEventListener('click', ()=> {
    tabs.forEach(x=> x.classList.remove('active'));
    t.classList.add('active');
    setMode(t.dataset.mode);
  }));
  function setMode(m){
    current = m;
    document.getElementById('modeName').textContent = m.charAt(0).toUpperCase() + m.slice(1);
    modes.forEach(md=>{
      const el = document.getElementById('mode-'+md);
      if(el) el.classList.toggle('hidden', md !== m);
    });
    document.getElementById('keypadWrap').style.display = (m === 'normal') ? 'block' : 'none';
    if(m !== 'normal'){ screen.textContent = '0'; } else { screen.textContent = expr || '0'; }
  }
  setMode('normal');

  /* KEYPAD (NORMAL) */
  const keys = document.querySelectorAll('.key');
  const safePattern = /^[0-9+\-*/().%\s]+$/;
  function updateScreen(v){ screen.textContent = v; }
  function appendChar(ch){ expr += ch; updateScreen(expr || '0'); }
  function backspace(){ expr = expr.slice(0,-1); updateScreen(expr || '0'); }
  function clearAll(){ expr = ''; updateScreen('0'); }
  function safeEval(s){
    if(!s || !s.trim()) throw 'Empty';
    if(!safePattern.test(s)) throw 'Invalid';
    s = s.replace(/×/g,'*').replace(/÷/g,'/').replace(/−/g,'-');
    s = s.replace(/([0-9.]+)%/g, '($1/100)');
    // evaluate using Function (quick). Input validated above.
    const fn = new Function('return ' + s);
    const v = fn();
    if(!isFinite(v)) throw 'Bad';
    return v;
  }
  keys.forEach(k=>{
    k.addEventListener('click', ()=> {
      const kx = k.dataset.key;
      if(kx === 'C'){ clearAll(); return; }
      if(kx === 'back'){ backspace(); return; }
      if(kx === 'ans'){ if(lastAns !== null) appendChar(String(lastAns)); return; }
      if(kx === '='){
        try{
          const val = safeEval(expr);
          lastAns = val;
          updateScreen(String(val));
          pushHist(`${expr} = ${val}`);
          expr = String(val);
        }catch(e){
          updateScreen('Error');
          setTimeout(()=> updateScreen(expr || '0'), 900);
        }
        return;
      }
      appendChar(kx);
    });
  });

  /* KEYBOARD SUPPORT (desktop or hardware) */
  window.addEventListener('keydown', ev=>{
    if(current !== 'normal') return;
    const allowed = '0123456789+-*/().%';
    if(allowed.includes(ev.key)) appendChar(ev.key);
    else if(ev.key === 'Enter') document.querySelector('.key[data-key="="]').click();
    else if(ev.key === 'Backspace') document.querySelector('.key[data-key="back"]').click();
    else if(ev.key === 'Escape') document.querySelector('.key[data-key="C"]').click();
  });

  /* AGE */
  document.getElementById('ageCalc').addEventListener('click', ()=>{
    const d = document.getElementById('dob').value; const out = document.getElementById('ageOut');
    if(!d){ out.textContent = 'Select date'; return; }
    const b = new Date(d + 'T00:00:00'); const n = new Date();
    if(b > n){ out.textContent = 'Birth in future'; return; }
    let y = n.getFullYear() - b.getFullYear(); let m = n.getMonth() - b.getMonth(); let day = n.getDate() - b.getDate();
    if(day < 0){ m -= 1; const prev = new Date(n.getFullYear(), n.getMonth(), 0); day += prev.getDate(); }
    if(m < 0){ y -= 1; m += 12; }
    out.textContent = `${y} years, ${m} months, ${day} days`;
    pushHist(`Age: DOB ${d} → ${y}y ${m}m ${day}d`);
  });
  document.getElementById('ageClear').addEventListener('click', ()=> { document.getElementById('dob').value=''; document.getElementById('ageOut').textContent=''; });

  /* INTEREST */
  const compoundChk = document.getElementById('compound'), nPer = document.getElementById('nPer');
  compoundChk.addEventListener('change', ()=> nPer.style.display = compoundChk.checked ? 'inline-block' : 'none');
  document.getElementById('intCalc').addEventListener('click', ()=>{
    const P = parseFloat(document.getElementById('P').value);
    const R = parseFloat(document.getElementById('R').value);
    const T = parseFloat(document.getElementById('T').value);
    const out = document.getElementById('intOut'), table = document.getElementById('intTable');
    out.textContent=''; table.innerHTML='';
    if(isNaN(P) || isNaN(R) || isNaN(T)){ out.textContent='Enter valid numbers'; return; }
    if(!compoundChk.checked){
      const SI = P * R * T / 100; const total = P + SI;
      out.textContent = `SI: ₹${SI.toFixed(2)} | Total: ₹${total.toFixed(2)}`;
      pushHist(`SI: P=${P},R=${R},T=${T} => SI=${SI.toFixed(2)}`);
    } else {
      const n = parseInt(nPer.value,10);
      const A = P * Math.pow(1 + (R/100)/n, n*T);
      out.textContent = `Amount: ₹${A.toFixed(2)}`;
      pushHist(`CI: P=${P},R=${R},n=${n},T=${T} => A=${A.toFixed(2)}`);
      // breakdown
      let bal = P; let rows = '<table style="width:100%;border-collapse:collapse"><tr><th style="text-align:left">Year</th><th style="text-align:right">Start</th><th style="text-align:right">End</th></tr>';
      for(let y=1;y<=Math.ceil(T);y++){
        const start = bal;
        for(let k=0;k<n && ((y-1) + (k+1)/n) <= T; k++) bal = bal * (1 + (R/100)/n);
        rows += `<tr><td style="padding:6px 0">Y ${y}</td><td style="text-align:right">₹${start.toFixed(2)}</td><td style="text-align:right">₹${bal.toFixed(2)}</td></tr>`;
      }
      rows += '</table>';
      table.innerHTML = rows;
    }
  });
  document.getElementById('intClear').addEventListener('click', ()=> {
    ['P','R','T'].forEach(id=>document.getElementById(id).value='');
    document.getElementById('intOut').textContent=''; document.getElementById('intTable').innerHTML=''; compoundChk.checked=false; nPer.style.display='none';
  });

  /* TIME DIFF */
  document.getElementById('timeCalc').addEventListener('click', ()=>{
    const s = document.getElementById('tStart').value, e = document.getElementById('tEnd').value, out = document.getElementById('timeOut');
    if(!s||!e){ out.textContent='Select both'; return; }
    const [sh,sm]=s.split(':').map(Number), [eh,em]=e.split(':').map(Number);
    let start = sh*60 + sm, end = eh*60 + em, diff = end - start;
    if(diff < 0) diff += 24*60;
    const hrs = Math.floor(diff/60), mins = diff%60;
    out.textContent = `${hrs} hours ${mins} minutes`;
    pushHist(`Time: ${s}→${e} = ${hrs}h ${mins}m`);
  });
  document.getElementById('timeClear').addEventListener('click', ()=> { document.getElementById('tStart').value=''; document.getElementById('tEnd').value=''; document.getElementById('timeOut').textContent=''; });

  /* HOURS+MIN */
  document.getElementById('hmCalc').addEventListener('click', ()=>{
    const H1 = parseInt(document.getElementById('h1').value||0,10), M1 = parseInt(document.getElementById('m1').value||0,10);
    const H2 = parseInt(document.getElementById('h2').value||0,10), M2 = parseInt(document.getElementById('m2').value||0,10);
    if([H1,M1,H2,M2].some(v=>isNaN(v))){ document.getElementById('hmOut').textContent='Enter valid numbers'; return; }
    let total = (H1*60 + M1) + (H2*60 + M2); const hrs = Math.floor(total/60), mins = total%60;
    document.getElementById('hmOut').textContent = `${hrs} hours ${mins} minutes`;
    pushHist(`H+M: ${H1}h${M1}m + ${H2}h${M2}m = ${hrs}h ${mins}m`);
  });
  document.getElementById('hmClear').addEventListener('click', ()=> { ['h1','m1','h2','m2'].forEach(id=>document.getElementById(id).value=''); document.getElementById('hmOut').textContent=''; });

  /* INIT render */
  renderHist();
}); // DOMContentLoaded
</script>
</body>
</html>
